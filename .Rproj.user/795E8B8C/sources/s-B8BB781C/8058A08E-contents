---
title: "Análise do resultado eleitoral da Juventude do PT"
author: 
  - Alexandre Freitas^[Militante da Juventude do PT de Belo Horizonte / MG, alexandrefreitas92@gmail.com]
  - João Vitor Leite Rodrigues^[Militante da Juventude do PT de Belo Horizonte / MG, jvleiterodrigues@gmail.com]
date: "`r format(Sys.Date(), '%d/%m/%Y')`"
output: 
  html_document:
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r Intro, message=FALSE}

library(tidyverse)
library(openxlsx)
library(readxl)
library(DT)
library(plotly)
library(knitr)
library(ggthemes)

vereadores_jovens_2020 <- read_csv("data/vereadores_jovens_2020.csv")
vereadores_jovens_2016 <- read_csv("data/vereadores_jovens_2016.csv")

n_eleitos_pt_mun_grande_2020 <- vereadores_jovens_2020 %>% filter(SG_PARTIDO == "PT") %>% summarise(n = sum(eleito=="Sim" & porte_municipio == "Grande"))

n_eleitos_pt_mun_grande_2016 <- vereadores_jovens_2016 %>% filter(SG_PARTIDO == "PT") %>% summarise(n = sum(eleito=="Sim" & porte_municipio == "Grande"))
```

Os(as) jovens candidatos(as) a vereador(a) do PT tiveram em 2020 mais ou menos votos do que em 2016? Quantos foram eleitos(as)? Há diferença no porte do município para o resultado eleitoral? Qual foi o perfil dos(as) jovens eleitos(as)? Esse perfil foi diferente do que em 2016? Se sim, essa mudança se deu especificamente no PT ou também se deu no conjunto dos(as) jovens eleitos(as)? Essas são algumas das perguntas que este texto busca responder.

As informações apresentadas neste texto foram retiradas do [site do TSE](https://www.tse.jus.br/eleicoes/estatisticas/repositorio-de-dados-eleitorais-1/repositorio-de-dados-eleitorais). Em decorrência de processos judiciais a votação dos(as) candidatos(as) para a eleição de 2020 de alguns municípios brasileiros não constava no site do TSE^[Acessado em 14 de julho de 2021]. Os municípios sem informação são: AMATURÁ, CONCEIÇÃO DO ARAGUAIA, MANAUS, MARABÁ, NOVO GAMA, PARANAGUÁ, PARAUAPEBAS, SANTA ISABEL DO PARÁ, SÃO PAULO DE OLIVENÇA, VERA CRUZ DO OESTE.

## Votação dos jovens petistas em 2020

Jovens Petistas tiveram ao todo `r vereadores_jovens_2020 %>% filter(SG_PARTIDO == "PT") %>% summarise(format(sum(votos_nominais), big.interval = 3L, big.mark=".", decimal.mark = ","))` votos para vereador, elegendo um total de `r vereadores_jovens_2020 %>% filter(SG_PARTIDO == "PT") %>% summarise(sum(eleito == "Sim"))` vereadores. Comparado a 2016 o resultado apresentou um aumento de `r format(vereadores_jovens_2020 %>% filter(SG_PARTIDO == "PT") %>% summarise(sum(votos_nominais)) - vereadores_jovens_2016 %>% filter(SG_PARTIDO == "PT") %>% summarise(sum(votos_nominais)), big.interval = 3L, big.mark=".", decimal.mark = ",")` votos, o equivalente a `r paste(format(round((vereadores_jovens_2020 %>% filter(SG_PARTIDO == "PT") %>% summarise(sum(votos_nominais)) - vereadores_jovens_2016 %>% filter(SG_PARTIDO == "PT") %>% summarise(sum(votos_nominais))) / vereadores_jovens_2016 %>% filter(SG_PARTIDO == "PT") %>% summarise(sum(votos_nominais)) * 100, digits = 2), big.interval = 3L, big.mark=".", decimal.mark = ","), "%", sep = "")`. Além do aumento na votação da juventude do PT, houve também uma mudança na composição das cadeiras ocupadas pelos jovens com o aumento do número de jovens eleitos(as) nos municípios grandes - de `r n_eleitos_pt_mun_grande_2016$n` para `r n_eleitos_pt_mun_grande_2020$n`, um aumento de `r (n_eleitos_pt_mun_grande_2020$n - n_eleitos_pt_mun_grande_2016$n)/n_eleitos_pt_mun_grande_2016$n * 100`% - e um progresso relevante no número de mulheres e de negras(os) eleitos, indicando uma mudança no perfil dos(as) jovens eleitos(as) pelo PT. Para a análise dividimos os municípios entre municípios pequenos com menos de 50 mil habitantes, municípios médios com mais de 50 mil habitantes e com menos de 200 mil eleitores, e municípios grandes com mais de 200 mil eleitores. Decidimos utilizar a medida de número de eleitores para a definição de municípios grandes pelo fato de ser o critério do TSE para definição dos municípios que possuem segundo turno.

```{r Eleitos, message=FALSE}

# Evolução do Número de jovens petistas eleitos - 2020
votacao_vereadores_jovens_pt_2020 <- vereadores_jovens_2020 %>%
  ungroup() %>%
  filter(SG_PARTIDO == "PT") %>%
  group_by(porte_municipio) %>%
  summarise(`Eleitos 2020` = sum(eleito == "Sim"),
            `Votação 2020` = sum(votos_nominais),
            `Ano 2` = "2020") %>%
  select(`Ano 2`, everything()) %>%
  rename(`Porte Município` = porte_municipio)

# Evolução do Número de jovens petistas eleitos - 2016
votacao_vereadores_jovens_pt_2016 <- vereadores_jovens_2016 %>%
  ungroup() %>%
  filter(SG_PARTIDO == "PT") %>%
  group_by(porte_municipio) %>%
  summarise(`Eleitos 2016` = sum(eleito == "Sim"),
            `Votação 2016` = sum(votos_nominais),
            `Ano 1` = "2016") %>%
  select(porte_municipio,`Ano 1`, everything()) %>%
  rename(`Porte Município` = porte_municipio)

votacao_vereadores_jovens_pt_2020_2016 <- votacao_vereadores_jovens_pt_2016 %>%
  left_join(votacao_vereadores_jovens_pt_2020, by = "Porte Município")

kable(votacao_vereadores_jovens_pt_2020_2016, 
      caption = "Votação dos jovens petistas para vereador nos anos de 2016 e 2020",
      format.args = list(big.interval = 3L, big.mark=".", decimal.mark = ",")
      )
```

Além do crescimento do número de vereadores nas cidades grandes, um ponto de destaque a ser analisado é a grande mudança no perfil dos(as) jovens eleitos(as). Nossos jovens eleitos são cada vez mais mulheres e negros(as).

```{r Genero_PT, message=FALSE, warning=FALSE}

# Análise PT

# 2020

# Tabela - Genero
genero_pt_por_porte_2020 <- vereadores_jovens_2020 %>%
  ungroup() %>%
  filter(SG_PARTIDO == "PT" & eleito == "Sim") %>%
  group_by(porte_municipio) %>%
  count(DS_GENERO) %>%
  mutate(total = sum(n),
         percentual = n / total * 100,
         percentual = round(percentual, digits = 2)) %>%
  mutate(porte_municipio = factor(porte_municipio, levels = c("Pequeno", "Médio", "Grande")))

# Grafico - Genero
fig_genero_pt_por_porte_2020 <- genero_pt_por_porte_2020 %>%
  rename("Gênero" = DS_GENERO, "Percentual" = percentual, "Porte do município" = porte_municipio) %>%
  ggplot(aes(fill=`Gênero`, y=Percentual, x=`Porte do município`,
             text = paste("Percentual", Percentual))) + 
  scale_y_continuous(labels=scales::percent, name = "") +
  geom_bar(position="fill", stat="identity") +
  labs(fill = "", title = "Vereadores(as) jovens do PT eleitos por gênero e porte do município - 2020") +
  xlab("Porte do Município") +
  ylab("Porcentagem (%)") +
  scale_fill_brewer(palette = "Set2")


ggplotly(fig_genero_pt_por_porte_2020, tooltip = c("size", "colour", "text")) %>%
  layout(legend=list(title=list(text='')))

# 2016

# Tabela - Genero
genero_pt_por_porte_2016 <- vereadores_jovens_2016 %>%
  ungroup() %>%
  filter(SG_PARTIDO == "PT" & eleito == "Sim") %>%
  group_by(porte_municipio) %>%
  count(DS_GENERO) %>%
  mutate(total = sum(n),
         percentual = n / total * 100,
         percentual = round(percentual, digits = 2)) %>%
  mutate(porte_municipio = factor(porte_municipio, levels = c("Pequeno", "Médio", "Grande")))

# Grafico - Genero
fig_genero_pt_por_porte_2016 <- genero_pt_por_porte_2016 %>%
  rename("Gênero" = DS_GENERO, "Percentual" = percentual, "Porte do município" = porte_municipio) %>%
  ggplot(aes(fill=`Gênero`, y=Percentual, x=`Porte do município`,
             text = paste("Percentual", Percentual))) + 
  scale_y_continuous(labels=scales::percent, name = "") +
  geom_bar(position="fill", stat="identity") +
  labs(fill = "", title = "Vereadores(as) jovens do PT eleitos por gênero e porte do município - 2016") +
  xlab("Porte do Município") +
  ylab("Porcentagem (%)") +
  scale_fill_brewer(palette = "Set2")

ggplotly(fig_genero_pt_por_porte_2016, tooltip = c("size", "colour", "text")) %>%
  layout(legend=list(title=list(text='')))

```

Ao analisarmos a composição de gênero e cor/raça no conjunto de todos os jovens eleitos de todos os partidos políticos vemos que essa mudança não só não ocorreu como a disparidade de homens brancos eleitos continua elevada.

```{r Genero_Geral, message=FALSE, warning=FALSE}
# Análise geral

# 2020

# Tabela - Gênero
genero_geral_por_porte <- vereadores_jovens_2020 %>%
  ungroup() %>%
  filter(eleito == "Sim") %>%
  group_by(porte_municipio) %>%
  count(DS_GENERO) %>%
  mutate(total = sum(n),
         percentual = n / total * 100,
         percentual = round(percentual, digits = 2)) %>%
  mutate(porte_municipio = factor(porte_municipio, levels = c("Pequeno", "Médio", "Grande")))

# Grafico - Genero
fig_genero_geral_por_porte <- genero_geral_por_porte %>%
  rename("Gênero" = DS_GENERO, "Percentual" = percentual, "Porte do município" = porte_municipio) %>%
  ggplot(aes(fill=`Gênero`, y=Percentual, x=`Porte do município`,
             text = paste("Percentual", Percentual))) + 
  scale_y_continuous(labels=scales::percent, name = "") +
  geom_bar(position="fill", stat="identity") +
  labs(fill = "", title = "Vereadores(as) jovens eleitos por gênero e porte do município - 2020") +
  xlab("Porte do Município") +
  ylab("Porcentagem (%)") +
  scale_fill_brewer(palette = "Set2")

ggplotly(fig_genero_geral_por_porte, tooltip = c("size", "colour", "text")) %>%
  layout(legend=list(title=list(text='')))
```

Ao analisarmos os dados de cor/raça percebemos fica ainda mais evidente essa mudança de composição, de forma que nas grandes cidades, os(as) jovens petistas eleitos(as) são 70% negras(os).

```{r Raca_Cor_PT, message=FALSE, warning=FALSE}

# 2020

# Tabela - Raca/Cor
raca_cor_pt_por_porte_2020 <- vereadores_jovens_2020 %>%
  ungroup() %>%
  filter(SG_PARTIDO == "PT" & eleito == "Sim") %>%
  group_by(porte_municipio) %>%
  count(DS_COR_RACA) %>%
  mutate(total = sum(n),
         percentual = n / total * 100,
         percentual = round(percentual, digits = 2)) %>%
  mutate(porte_municipio = factor(porte_municipio, levels = c("Pequeno", "Médio", "Grande")))

# Grafico - Raca/Cor
fig_raca_cor_pt_por_porte_2020 <- raca_cor_pt_por_porte_2020 %>%
  rename("Raça/Cor" = DS_COR_RACA, "Percentual" = percentual, "Porte do município" = porte_municipio) %>%
  ggplot(aes(fill=`Raça/Cor`, y=Percentual, x=`Porte do município`,
             text = paste("Percentual", Percentual))) + 
  scale_y_continuous(labels=scales::percent, name = "") +
  geom_bar(position="fill", stat="identity") +
  labs(fill = "", title = "Vereadores(as) jovens do PT eleitos por Raça/Cor e porte do município - 2020") +
  xlab("Porte do Município") +
  ylab("Porcentagem (%)") +
  scale_fill_brewer(palette = "Set2")

ggplotly(fig_raca_cor_pt_por_porte_2020, tooltip = c("size", "colour", "text")) %>%
  layout(legend=list(title=list(text='')))

# 2016

# Tabela - Raca/Cor
raca_cor_pt_por_porte_2016 <- vereadores_jovens_2016 %>%
  ungroup() %>%
  filter(SG_PARTIDO == "PT" & eleito == "Sim") %>%
  group_by(porte_municipio) %>%
  count(DS_COR_RACA) %>%
  mutate(total = sum(n),
         percentual = n / total * 100,
         percentual = round(percentual, digits = 2)) %>%
  mutate(porte_municipio = factor(porte_municipio, levels = c("Pequeno", "Médio", "Grande")))

# Grafico - Raca/Cor
fig_raca_cor_pt_por_porte_2016 <- raca_cor_pt_por_porte_2016 %>%
  rename("Raça/Cor" = DS_COR_RACA, "Percentual" = percentual, "Porte do município" = porte_municipio) %>%
  ggplot(aes(fill=`Raça/Cor`, y=Percentual, x=`Porte do município`,
             text = paste("Percentual", Percentual))) + 
  scale_y_continuous(labels=scales::percent, name = "") +
  geom_bar(position="fill", stat="identity") +
  labs(fill = "", title = "Vereadores(as) jovens do PT eleitos por Raça/Cor e porte do município - 2016") +
  xlab("Porte do Município") +
  ylab("Porcentagem (%)") +
  scale_fill_brewer(palette = "Set2")

ggplotly(fig_raca_cor_pt_por_porte_2016, tooltip = c("size", "colour", "text")) %>%
  layout(legend=list(title=list(text='')))
```

Ao observarmos os dados do conjunto dos vereadores jovens eleitos de todos os partidos vemos, de novo, que isso se deu no PT.

```{r Raca_Cor_Geral, message=FALSE, warning=FALSE}
# 2020

# Tabela - Raca/Cor
raca_cor_geral_por_porte <- vereadores_jovens_2020 %>%
  ungroup() %>%
  filter(eleito == "Sim") %>%
  group_by(porte_municipio) %>%
  count(DS_COR_RACA) %>%
  mutate(total = sum(n),
         percentual = n / total * 100,
         percentual = round(percentual, digits = 2)) %>%
  mutate(porte_municipio = factor(porte_municipio, levels = c("Pequeno", "Médio", "Grande")))

# Grafico - Raca/Cor
fig_raca_cor_geral_por_porte <- raca_cor_geral_por_porte %>%
  rename("Raça/Cor" = DS_COR_RACA, "Percentual" = percentual, "Porte do município" = porte_municipio) %>%
  ggplot(aes(fill=`Raça/Cor`, y=Percentual, x=`Porte do município`,
             text = paste("Percentual", Percentual))) + 
  scale_y_continuous(labels=scales::percent, name = "") +
  geom_bar(position="fill", stat="identity") +
  labs(fill = "", title = "Vereadores(as) jovens eleitos por Raça/Cor e porte do município - 2020") +
  xlab("Porte do Município") +
  ylab("Porcentagem (%)") + 
  scale_fill_brewer(palette = "Set2")

ggplotly(fig_raca_cor_geral_por_porte, tooltip = c("size", "colour", "text")) %>%
  layout(legend=list(title=list(text='')))


```

O Partido dos Trabalhadores teve nessas eleições de 2020 uma mudança qualitativa no perfil dos(as) canidatos(as) eleitos(as). Crescemos aonde precisávamos crescer, que é nas grandes cidades, e quem elegemos se parece muito mais com o conjunto do povo brasileiro do que quem elegiamos anteriormente. Essa mudança qualitativa do PT será fundamental para a reestruturação e o fortalecimento do partido e da esquerda brasileira e demonstrou o sucesso que foi o Movimento Representa que estimulou e fortificou as candidaturas de jovens petistas.

Veja como foi a votação dos jovens petistas nessa última eleição:

```{r Tabela_Sintese, message=FALSE, warning=FALSE}
# Vereadores jovens do PT
vereadores_jovens_pt <- vereadores_jovens_2020 %>%
  filter(SG_PARTIDO == "PT") %>%
  select(-SG_PARTIDO)

# Apresentar tabela com a lista dos vereadores eleitos pelo PT
datatable(vereadores_jovens_pt,
          filter = 'top',
          colnames = c("UF", "Município","Candidata", "Porte do Município", "Votação",
                                              "Gênero", "Cor/ raça", "Eleita?", "Perc de votos"),
          caption = "Tabela com todos(as) os(as) candidatos a vereador jovens do PT em 2020") %>%
  formatPercentage("percentual", 2) %>%
  formatRound("votos_nominais", mark = ".", digits = 0)
```

O script utilizado para a compilação da informação pode ser acessado em <https://github.com/alexandrefreitas92/analise_eleicoes2020>.
